# ConAPI. Техническое задание

# Описание  
ConAPI - Connection API, универсальная библиотека-обертка (wrapper) на Python позволяющая работать с API различных маркетплейсов:
1. Вайлдберис
2. Озон
3. ЯндексМаркет
4. АлиЭкспресс (Россия)
5. СберМакрет

## Цель  
Целью библиотеки является значительное упрощение работы с маркетплейсами за счет унификации работы с API. 

## Python методы для реализации:
- check_creds(token) - проверка доступа для токена
- get_prds(filter) - список товаров продавца на МП
- get_prd(prd_id) - полный агрегированный набор данных по товару (атрибутуты, цены, остатки, модели продаж, итд) 
- set_prd(prd_id) - изменение произвольного атрибута товара
- get_categories(filter) - получение списка категорий МП
- get_orders(filter) - получение списка заказов
- get_comission(prd_id) - получение данных по комисси для товара


# Кэширование (опционально)
TODO Описать модель и реалиизацию кэшеирования

# Тесты: 
TODO Описать запуск тестов

# Установка
TODO Описать процесс установки

# References

## Документация по API
- Документация по API ВБ https://dev.wildberries.ru/
- Документация по API Озон https://docs.ozon.ru/api/seller/

## Материалы по Django:
- https://www.w3schools.com/django/
- https://www.geeksforgeeks.org/django-tutorial/
- https://docs.djangoproject.com/en/5.2/

# ИНСТРУКЦИЯ по применению
1. Создайте виртуальне окружение
```bash
python -m venv venv
```
2. Активируйте его
```bash
source venv/bin/activate
```
3. Установите необходимые зависимости
```bash
python -m pip install -r requirements.txt
```
4. Установите переменную среды (Ваш токен):
   - либо создайте в корне проекта файл .env (проект сам подсосет с него WB_API_TOKEN)
   - либо в терминале введите 
```bash
export WB_API_TOKEN="Ваш токен"
```
5. Класс обертка находится в модуле api_wrapper. 
```python
# Импортируйте его во views.py для применения
from api_wrapper import WildberriesAPIWrapper
# Пример создания экземпляра и вызова методов
api = WildberriesAPIWrapper()
```
6. 
- Запуск комплексного теста 
```bash
python manage.py test
```
- апуск тестов для конкретного приложения 
```bash
python manage.py test myapp
```
- Запуск тестов для конкретного модуля 
```bash
python manage.py test myapp.tests.test_models
```
- Запуск тестов для конкретного класса 
```bash
python manage.py test myapp.tests.test_models.MyModelTest
```
- Запуск тестов для конкретной функции 
```bash
python manage.py test myapp.tests.test_models.MyModelTest.test_instance_name
```

Объяснение тестов:
- `test_get_prds:`
Патчим `requests.get` и готовим моковский ответ с продукцией.
Проверяем, что метод отправляет запрос с правильным URL и заголовками авторизации.
Возвращенное значение сравниваем с ожидаемым результатом.
- `test_get_prd:`
Повторяем процедуру с отдельным продуктом, передавая конкретный ID продукта.
Проверяем правильность формирования URL и обработку ответа.
- `test_set_prd:`
Используем патч для метода `requests.patch`, чтобы подготовить изменение цены продукта.
Проверяем, что отправляются корректные данные и заголовки.
- `test_get_orders:`
Тестируем метод получения заказов аналогичным образом.
- `test_get_commission:`
Тестируем метод получения комиссии, передавая конкретные даты начала и окончания периода.

Эти тесты обеспечивают полное покрытие функционала класса WildberriesAPIWrapper, гарантируя корректность запросов и обработки ответов. В реальных проектах рекомендуется также проверять обработку возможных ошибок и нестандартных ситуаций (например, если сервис Wildberries возвращает некорректный ответ или произошла ошибка сети).

### Итоги

По итогам выполнения задания получаем следующий результат:

- Разработан модуль-обёртка для работы с API Wildberries на Python/Django.
- Проведено полное покрытие методами тестирования.
- Предоставлена инструкция по развертыванию и использованию решения.

Результатом выполнения задания - готовая инфраструктура для интеграции с API Wildberries, которую компания сможет использовать для автоматизации бизнес-процессов продавцов на маркетплейсе.

# ВНИМАНИЕ! Нужно дополнительно проверить эндпоинты и базовый url на соответствие технической документации